clear all;
rng(1,'twister');

% Select a value for theta and data size
theta=[5;2];
N=50;

% Generate observations
error_var = 1;
g1 = ones(N,1);
g2 = [1:N]';
G = [g1 g2];
y = G*theta + sqrt(error_var)*randn(N,1);

% ML estimate for theta
theta_ML = inv(transpose(G)*G)*transpose(G)*y

% Prior distribution parameters
theta_prior = [4;2];
prior_var = [1 0 ; 0 0.1];

% Likelihood parameters
likelihood_var = error_var*inv((transpose(G)*G));

% Posterior parameters
phi = transpose(G)*G + error_var*inv(prior_var);
big_theta = transpose(G)*y + error_var*inv(prior_var)*theta_prior;
theta_MAP = inv(phi)*big_theta
post_var = error_var*inv(phi);

% Generate plots
plot(y);
text(1,100,...
    sprintf('Actual theta1: %4.2f \nActual theta2: %4.2f \nML theta1: %4.2f \nML theta2: %4.2f \nMAP theta1: %4.2f \nMAP theta2: %4.2f',theta(1), theta(2), theta_ML(1), theta_ML(2), theta_MAP(1), theta_MAP(2)));
% % Posterior distribution
% x = [2:0.001:8];
% y_post = normpdf(x,theta_MAP,sqrt(post_var));
% y_likelihood = normpdf(x,theta_ML,sqrt(likelihood_var));
% y_prior = normpdf(x,theta_prior, sqrt(prior_var));
% plot(x, y_post) 
% hold on
% plot(x, y_likelihood)
% plot(x, y_prior)
% xline(theta_ML,'-.','ML')
% xline(theta_MAP,'-.','MAP')
% legend('Posterior','Likelihood','Prior')
% hold off